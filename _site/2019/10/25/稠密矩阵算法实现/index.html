<!DOCTYPE html><html><head><title> ç¨ å¯†çŸ©é˜µç®—æ³•å®ç° &middot; wu-kan</title><!-- Begin Jekyll SEO tag v2.7.1 --><meta name="generator" content="Jekyll v3.9.0" /><meta property="og:title" content="ç¨ å¯†çŸ©é˜µç®—æ³•å®ç°" /><meta property="og:locale" content="en_US" /><meta name="description" content="çŸ©é˜µ$A$ï¼Œ$B$å’Œå‘é‡$\vec{x}$æŒ‰ä¸‹é¢å®šä¹‰å…ƒç´ ï¼š $a_{ij}=\frac{i-0.1\times j+1}{i+j+1}$ $b_{ij}=\frac{(j-0.2\times i+1)(i+j+1)}{i\times i+j\times j+1}$ $x_i=\frac{i}{i\times i+1}$" /><meta property="og:description" content="çŸ©é˜µ$A$ï¼Œ$B$å’Œå‘é‡$\vec{x}$æŒ‰ä¸‹é¢å®šä¹‰å…ƒç´ ï¼š $a_{ij}=\frac{i-0.1\times j+1}{i+j+1}$ $b_{ij}=\frac{(j-0.2\times i+1)(i+j+1)}{i\times i+j\times j+1}$ $x_i=\frac{i}{i\times i+1}$" /><link rel="canonical" href="http://localhost:4000/2019/10/25/%E7%A8%A0%E5%AF%86%E7%9F%A9%E9%98%B5%E7%AE%97%E6%B3%95%E5%AE%9E%E7%8E%B0/" /><meta property="og:url" content="http://localhost:4000/2019/10/25/%E7%A8%A0%E5%AF%86%E7%9F%A9%E9%98%B5%E7%AE%97%E6%B3%95%E5%AE%9E%E7%8E%B0/" /><meta property="og:site_name" content="wu-kan" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2019-10-25T00:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="ç¨ å¯†çŸ©é˜µç®—æ³•å®ç°" /><meta name="google-site-verification" content="YIKi1rBnyUaS-DMYiluseI5kZzTwjCkTFmKkSkMZDJk" /><meta name="baidu-site-verification" content="szbTSfUGAB" /> <script type="application/ld+json"> {"@type":"BlogPosting","url":"http://localhost:4000/2019/10/25/%E7%A8%A0%E5%AF%86%E7%9F%A9%E9%98%B5%E7%AE%97%E6%B3%95%E5%AE%9E%E7%8E%B0/","datePublished":"2019-10-25T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2019/10/25/%E7%A8%A0%E5%AF%86%E7%9F%A9%E9%98%B5%E7%AE%97%E6%B3%95%E5%AE%9E%E7%8E%B0/"},"headline":"ç¨ å¯†çŸ©é˜µç®—æ³•å®ç°","description":"çŸ©é˜µ$A$ï¼Œ$B$å’Œå‘é‡$\\vec{x}$æŒ‰ä¸‹é¢å®šä¹‰å…ƒç´ ï¼š $a_{ij}=\\frac{i-0.1\\times j+1}{i+j+1}$ $b_{ij}=\\frac{(j-0.2\\times i+1)(i+j+1)}{i\\times i+j\\times j+1}$ $x_i=\\frac{i}{i\\times i+1}$","dateModified":"2019-10-25T00:00:00+08:00","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --><meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1" /><meta http-equiv="content-type" content="text/html; charset=utf-8" /><link rel="alternate" href="/feed.xml" title="RSS" type="application/rss+xml" /><link rel="apple-touch-icon-precomposed" href="https://gravatar.loli.net/avatar/289efba375d63424de3c49569c446744?s=320" /><link rel="shortcut icon" href="https://gravatar.loli.net/avatar/289efba375d63424de3c49569c446744?s=32" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/combine/gh/poole/lanyon@v1.1.0/public/css/poole.min.css,gh/poole/lanyon@v1.1.0/public/css/lanyon.min.css,gh/poole/lanyon@v1.1.0/public/css/syntax.min.css" /> <script async="async" src="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/js/all.min.js" ></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Dreamer-Paul/Pio@2.4/static/pio.min.css" /><style> @media only print { .pio-container { display: none; } }</style><script async="async" src="https://cdn.jsdelivr.net/combine/gh/Dreamer-Paul/Pio@2.4/static/l2d.min.js,gh/Dreamer-Paul/Pio@2.4/static/pio.min.js" onload=' let pio_container = document.createElement("div"); pio_container.classList.add("pio-container"); pio_container.classList.add("right"); pio_container.style.bottom = "-2rem"; pio_container.style.zIndex = "1"; document.body.insertAdjacentElement("beforeend", pio_container); let pio_action = document.createElement("div"); pio_action.classList.add("pio-action"); pio_container.insertAdjacentElement("beforeend", pio_action); let pio_canvas = document.createElement("canvas"); pio_canvas.id = "pio"; pio_canvas.style.width = "14rem"; pio_canvas.width = "600"; pio_canvas.height = "800"; pio_container.insertAdjacentElement("beforeend", pio_canvas); let pio = new Paul_Pio({ "mode": "fixed", "hidden": true, "night": "for(let i=7; i<16; ++i) if(document.body.classList.contains(`theme-base-0`+i.toString(16))) { document.body.classList.remove(`theme-base-0`+i.toString(16)); document.body.classList.add(`theme-base-0`+((i-6)%9+7).toString(16)); break; }", "content": { "link": ["https:\/\/jekyll-theme-WuK.wu-kan.cn"], "skin": ["è¦æ¢æˆæˆ‘çš„æœ‹å‹å—ï¼Ÿ", "è®©å¥¹æ”¾ä¸ªå‡å§~"], "hidden": true, "custom": [{ "selector": "a", "type": "link", }, { "selector": ".sidebar-toggle", "text": "æ‰“å¼€ä¾§è¾¹æ å­~" }, { "selector": ".effect-info", "text": "å“‡ï¼Œä½ å‘ç°äº†ä»€ä¹ˆï¼" }, { "selector": "#sidebar-search-input", "text": "æƒ³æœç´¢ä»€ä¹ˆå‘¢ï¼Ÿå¾ˆå¤šå¹²è´§å“¦ï¼" }, { "selector": "#toc", "text": "è¿™æ˜¯ç›®å½•~" }, { "selector": ".page-title", "text": "è¿™æ˜¯æ ‡é¢˜~" }, { "selector": ".v", "text": "è¯„è®ºæ²¡æœ‰å®¡æ ¸ï¼Œè¦å¯¹è‡ªå·±çš„å‘è¨€è´Ÿè´£å“¦~" }] }, "model": [ "https:\/\/cdn.jsdelivr.net/gh/imuncle/live2d/model/33/model.2018.bls-winter.json", "https:\/\/cdn.jsdelivr.net/gh/imuncle/live2d/model/platelet-2/model.json", "https:\/\/cdn.jsdelivr.net/gh/imuncle/live2d/model/xiaomai/xiaomai.model.json", "https:\/\/cdn.jsdelivr.net/gh/imuncle/live2d/model/mashiro/seifuku.model.json", "https:\/\/cdn.jsdelivr.net/gh/imuncle/live2d/model/Violet/14.json", "https:\/\/cdn.jsdelivr.net/gh/xiaoski/live2d_models_collection/Kobayaxi/Kobayaxi.model.json", "https:\/\/cdn.jsdelivr.net/gh/xiaoski/live2d_models_collection/mikoto/mikoto.model.json", "https:\/\/cdn.jsdelivr.net/gh/xiaoski/live2d_models_collection/uiharu/uiharu.model.json"] });' ></script> <script src='https://zz.bdstatic.com/linksubmit/push.js' async="async" ></script><style> .wrap { transition-property: width,background-size,transform; transition-duration: .3s; transition-timing-function: ease-in-out; min-height: 100%; display: inline-block; background-size: 100% auto; background-position: 0% 0%; background-repeat: no-repeat; background-attachment: fixed; background-image: url(https://Mizuno-Ai.wu-kan.cn/pixiv/74559485_p1.webp); } @media (min-aspect-ratio: 2400/1850) { .wrap { background-image: url(https://Mizuno-Ai.wu-kan.cn/pixiv/71932901_p0.webp); } } .sidebar-overlay #sidebar-checkbox:checked ~ .wrap { width: calc(100% - 14rem); background-size: calc(100% - 14rem) auto; transform: translateX(14rem); } .layout-reverse.sidebar-overlay #sidebar-checkbox:checked ~ .wrap { transform: translateX(0); }</style><style> .sidebar, html, h1, h2, h3, h4, h5, h6 { font-family: "Courier New", "Courier", "Hiragino Sans GB", "WenQuanYi Micro Hei", "Microsoft YaHei Light", "Microsoft JhengHei", monospace; }</style><style> td, th { padding: 0px; border: 0px; } table { border: 0px; } table tbody { display: block; overflow: scroll; } table thead, tbody tr { display: table; table-layout: fixed; width: 100%; }</style><style> img { display: inline-block; margin: 0; }</style><style> ::-webkit-scrollbar { width: 3px; height: 3px; } ::-webkit-scrollbar-thumb { background-image: linear-gradient(45deg, Cyan 0%, Magenta 50%, Yellow 100%); }</style><style> ::selection { color: White; background: Black; }</style><body class="theme-base-0d layout-reverse sidebar-overlay"> <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular styles, `#sidebar-checkbox` for behavior. --> <input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox" /> <!-- Toggleable sidebar --><div class="sidebar" id="sidebar"><div class="sidebar-item"><div class="effect effect-right_to_left"> <img class="effect-img" src="https://gravatar.loli.net/avatar/289efba375d63424de3c49569c446744?s=320" alt="img" /><div class="effect-info"> SYSUè¶…ç®—17çº§åœ¨è¯»<br/> æ°´é‡çˆ±<br/> HPC<br/> ç”°å®«ä¾‹å››é©±è½¦<br/> <a href="mailto:i@wu-kan.cn"> <i class="fas fa-envelope"></i> </a> <a href="https://github.com/wu-kan"> <i class="fab fa-github"></i> </a> <a href="https://codeforces.com/profile/WuK"> <i class="fas fa-chart-bar"></i> </a> <a href="https://vjudge.net/user/WuK"> <i class="fas fa-smile"></i> </a> <a href="https://www.zhihu.com/people/wu.kan/activities"> <i class="fab fa-zhihu"></i> </a> <iframe src="https://music.163.com/outchain/player?type=0&id=155059595&auto=0&height=32" width=100% height=52 frameborder="no" border="0" marginwidth="0" marginheight="0" ></iframe></div></div></div><nav class="sidebar-nav"> <a class="sidebar-nav-item" href="/"> <i class="fas fa-home fa-fw"></i> é¦–é¡µ </a> <a class="sidebar-nav-item" href="/comments/"> <i class="fas fa-comments fa-fw"></i> ç•™è¨€ </a> <a class="sidebar-nav-item" href="/tags/"> <i class="fas fa-tags fa-fw"></i> æ ‡ç­¾ </a> <a class="sidebar-nav-item" href="/archive/"> <i class="fas fa-archive fa-fw"></i> å½’æ¡£ </a> <a class="sidebar-nav-item" href="/merger/"> <i class="fas fa-coffee fa-fw"></i> æ‰“èµ </a></nav><div class="sidebar-item"><style> #sidebar-search-input { background: none; border: none; color: White; width: 100%; } #sidebar-search-results-container { overflow: auto auto; max-height: 66.6vh; }</style><input id="sidebar-search-input" placeholder="æœç´¢åšæ–‡" /><ol id="sidebar-search-results-container" ></ol><script src='https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.9.1' async='async' onload=' SimpleJekyllSearch({ json: "/assets/simple-jekyll-search/search.json", searchInput: document.getElementById("sidebar-search-input"), resultsContainer: document.getElementById("sidebar-search-results-container"), searchResultTemplate: `<li><a href="{url}">{title}</a>`, limit: 999, fuzzy: true })' ></script><style> #toc { overflow: auto auto; max-height: 66.6vh; }</style><ol id="toc"><li><a href="#%E5%AE%8C%E6%88%90%E7%9F%A9%E9%98%B5%E5%90%91%E9%87%8F%E4%B9%98avecx%E7%9A%84-mpi-%E5%B9%B6%E8%A1%8C%E7%AE%97%E6%B3%95%E8%A6%81%E6%B1%82%E5%AF%B9%E7%9F%A9%E9%98%B5%E9%87%87%E7%94%A8-2-%E7%BB%B4%E5%88%92%E5%88%86">å®ŒæˆçŸ©é˜µå‘é‡ä¹˜$A\vec{x}$çš„ MPI å¹¶è¡Œç®—æ³•ï¼Œè¦æ±‚å¯¹çŸ©é˜µé‡‡ç”¨ 2 ç»´åˆ’åˆ†</a><ol><li><a href="#%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90">åŸç†åˆ†æ</a><li><a href="#%E6%BA%90%E4%BB%A3%E7%A0%81matvecmulc">æºä»£ç MatVecMul.c</a><li><a href="#%E8%B0%83%E5%BA%A6%E8%84%9A%E6%9C%ACmatvecmulpbs">è°ƒåº¦è„šæœ¬MatVecMul.pbs</a><li><a href="#%E8%AE%A1%E7%AE%97%E7%AE%97%E6%B3%95%E7%9A%84%E8%BF%90%E8%A1%8C%E6%97%B6%E9%97%B4%E5%A1%AB%E8%A1%A8">è®¡ç®—ç®—æ³•çš„è¿è¡Œæ—¶é—´ï¼Œå¡«è¡¨</a><ol><li><a href="#%E8%BF%90%E8%A1%8C%E6%97%B6%E9%97%B4">è¿è¡Œæ—¶é—´</a><li><a href="#%E5%8A%A0%E9%80%9F%E6%AF%94">åŠ é€Ÿæ¯”</a><li><a href="#%E8%BF%90%E7%AE%97%E6%95%88%E7%8E%87">è¿ç®—æ•ˆç‡</a><li><a href="#%E9%AA%8C%E8%AF%81%E7%AD%89%E6%95%88%E7%8E%87%E5%87%BD%E6%95%B0">éªŒè¯ç­‰æ•ˆç‡å‡½æ•°</a></ol></ol><li><a href="#%E7%AE%80%E5%8D%95%E7%9F%A9%E9%98%B5%E4%B9%98%E6%B3%95cab%E7%9F%A9%E9%98%B5%E9%87%87%E7%94%A8-2-%E7%BB%B4%E5%88%92%E5%88%86">ç®€å•çŸ©é˜µä¹˜æ³•$C=AB$ï¼ˆçŸ©é˜µé‡‡ç”¨ 2 ç»´åˆ’åˆ†ï¼‰</a><ol><li><a href="#%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90-1">åŸç†åˆ†æ</a><li><a href="#%E6%BA%90%E4%BB%A3%E7%A0%81matmatmulc">æºä»£ç MatMatMul.c</a><li><a href="#%E8%B0%83%E5%BA%A6%E8%84%9A%E6%9C%ACmatmatmulpbs">è°ƒåº¦è„šæœ¬MatMatMul.pbs</a><li><a href="#%E8%AE%A1%E7%AE%97%E7%AE%97%E6%B3%95%E7%9A%84%E8%BF%90%E8%A1%8C%E6%97%B6%E9%97%B4%E5%A1%AB%E8%A1%A8-1">è®¡ç®—ç®—æ³•çš„è¿è¡Œæ—¶é—´ï¼Œå¡«è¡¨</a><ol><li><a href="#%E8%BF%90%E8%A1%8C%E6%97%B6%E9%97%B4-1">è¿è¡Œæ—¶é—´</a><li><a href="#%E5%8A%A0%E9%80%9F%E6%AF%94-1">åŠ é€Ÿæ¯”</a><li><a href="#%E8%BF%90%E7%AE%97%E6%95%88%E7%8E%87-1">è¿ç®—æ•ˆç‡</a><li><a href="#%E9%AA%8C%E8%AF%81%E7%AD%89%E6%95%88%E7%8E%87%E5%87%BD%E6%95%B0-1">éªŒè¯ç­‰æ•ˆç‡å‡½æ•°</a></ol></ol><li><a href="#%E7%9F%A9%E9%98%B5%E4%B9%98%E6%B3%95cab%E7%9A%84-cannon-%E7%AE%97%E6%B3%95">çŸ©é˜µä¹˜æ³•$C=AB$çš„ CANNON ç®—æ³•</a><ol><li><a href="#%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90-2">åŸç†åˆ†æ</a><li><a href="#%E6%BA%90%E4%BB%A3%E7%A0%81cannonc">æºä»£ç Cannon.c</a><li><a href="#%E8%B0%83%E5%BA%A6%E8%84%9A%E6%9C%ACcannonpbs">è°ƒåº¦è„šæœ¬Cannon.pbs</a><li><a href="#%E8%AE%A1%E7%AE%97%E7%AE%97%E6%B3%95%E7%9A%84%E8%BF%90%E8%A1%8C%E6%97%B6%E9%97%B4%E5%A1%AB%E8%A1%A8-2">è®¡ç®—ç®—æ³•çš„è¿è¡Œæ—¶é—´ï¼Œå¡«è¡¨</a><li><a href="#%E8%BF%90%E8%A1%8C%E6%97%B6%E9%97%B4-2">è¿è¡Œæ—¶é—´</a><li><a href="#%E5%8A%A0%E9%80%9F%E6%AF%94-2">åŠ é€Ÿæ¯”</a><ol><li><a href="#%E8%BF%90%E8%A1%8C%E6%95%88%E7%8E%87">è¿è¡Œæ•ˆç‡</a><li><a href="#%E9%AA%8C%E8%AF%81%E7%AD%89%E6%95%88%E7%8E%87%E6%A8%A1%E5%9E%8B">éªŒè¯ç­‰æ•ˆç‡æ¨¡å‹</a></ol></ol><li><a href="#%E7%9F%A9%E9%98%B5%E4%B9%98%E6%B3%95cab%E7%9A%84-dns-%E7%AE%97%E6%B3%95">çŸ©é˜µä¹˜æ³•$C=AB$çš„ DNS ç®—æ³•</a><ol><li><a href="#%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90-3">åŸç†åˆ†æ</a><li><a href="#%E6%BA%90%E4%BB%A3%E7%A0%81dnsc">æºä»£ç DNS.c</a><li><a href="#%E8%B0%83%E5%BA%A6%E8%84%9A%E6%9C%ACdnspbs">è°ƒåº¦è„šæœ¬DNS.pbs</a><li><a href="#%E8%AE%A1%E7%AE%97%E7%AE%97%E6%B3%95%E7%9A%84%E8%BF%90%E8%A1%8C%E6%97%B6%E9%97%B4%E5%A1%AB%E8%A1%A8-3">è®¡ç®—ç®—æ³•çš„è¿è¡Œæ—¶é—´ï¼Œå¡«è¡¨</a><ol><li><a href="#%E8%BF%90%E8%A1%8C%E6%97%B6%E9%97%B4-3">è¿è¡Œæ—¶é—´</a><li><a href="#%E5%8A%A0%E9%80%9F%E6%AF%94-3">åŠ é€Ÿæ¯”</a><li><a href="#%E8%BF%90%E8%A1%8C%E6%95%88%E7%8E%87-1">è¿è¡Œæ•ˆç‡</a><li><a href="#%E9%AA%8C%E8%AF%81%E7%AD%89%E6%95%88%E7%8E%87%E6%A8%A1%E5%9E%8B-1">éªŒè¯ç­‰æ•ˆç‡æ¨¡å‹</a></ol></ol></ol><style> .sidebar-checkbox { display: none; } .sidebar-toggle { position: fixed; }</style><style> .sidebar { overflow: scroll; min-height: 101%; }</style><style> .effect { margin: 1rem; perspective: 900px; } .effect-info { text-align: center; position: absolute; top: 0; transform-style: preserve-3d; } .effect-img { z-index: 11; width: 100%; height: 100%; position: relative; transition: all 0.5s ease-in-out; } .effect-img:before { position: absolute; display: block; } .effect-right_to_left .effect-img { transform-origin: 0% 50%; } .effect-right_to_left:hover .effect-img { transform: rotate3d(0, 1, 0, -180deg); }</style><div> <i class="fas fa-cog fa-spin fa-fw"></i> <span id="run_time_day"> <i class="fas fa-spinner fa-pulse"></i> </span>å¤© <span id="run_time_hour"> <i class="fas fa-spinner fa-pulse"></i> </span>æ—¶ <span id="run_time_minute"> <i class="fas fa-spinner fa-pulse"></i> </span>åˆ† <span id="run_time_second"> <i class="fas fa-spinner fa-pulse"></i> </span>ç§’ <script> setInterval(function (d,h,m,s,b) { function setzero(i) { return i < 10 ? "0" + i : i; } let BirthDay = new Date(b); let today = new Date(); let timeold = (today.getTime() - BirthDay.getTime()); let sectimeold = timeold / 1000; let secondsold = Math.floor(sectimeold); let msPerDay = 24 * 60 * 60 * 1000; let e_daysold = timeold / msPerDay; let daysold = Math.floor(e_daysold); let e_hrsold = (e_daysold - daysold) * 24; let hrsold = Math.floor(e_hrsold); let e_minsold = (e_hrsold - hrsold) * 60; let minsold = Math.floor((e_hrsold - hrsold) * 60); let seconds = Math.floor((e_minsold - minsold) * 60); d.textContent = daysold; h.textContent = setzero(hrsold); m.textContent = setzero(minsold); s.textContent = setzero(seconds); }, 1000, document.getElementById("run_time_day"), document.getElementById("run_time_hour"), document.getElementById("run_time_minute"), document.getElementById("run_time_second"), "10/04/2017 11:03:56")// è¿™æ˜¯æˆ‘ç¬¬ä¸€ç¯‡CSDNåšå®¢çš„æ—¶é—´ </script></div><div><div> <i class="fas fa-eye fa-fw"></i> <span id="busuanzi_value_page_pv"> <i class="fas fa-spinner fa-pulse"></i> </span>æ¬¡</div><div> <i class="fas fa-paw fa-fw"></i> <span id="busuanzi_value_site_pv"> <i class="fas fa-spinner fa-pulse"></i> </span>æš</div><div> <i class="fas fa-user-friends fa-fw"></i> <span id="busuanzi_value_site_uv"> <i class="fas fa-spinner fa-pulse"></i> </span>äºº</div><script src='https://cdn.jsdelivr.net/npm/busuanzi@2.3.0' async='async' ></script></div><div> <i class="fas fa-thumbs-up fa-fw"></i> <a href="https://jekyll-theme-WuK.wu-kan.cn"> jekyll-theme-WuK </a></div><div> <i class="fas fa-copyright fa-fw"></i> 2017-2021 WuK</div><div> <i class="fas fa-info-circle fa-fw"></i> <a href="http://beian.miit.gov.cn"> ç²¤ICPå¤‡ 20024947å· </a></div><div> <img src="https://i.loli.net/2021/03/17/Y47tDZTrcy2xwRa.png" class="fa-fw"></img> <a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=34070202000407"> çš–å…¬ç½‘å®‰å¤‡ 34070202000407å· </a></div></div></div><!-- Wrap is the content to shift when toggling the sidebar. We wrap the content to avoid any CSS collisions with our real content. --><div class="wrap"><style> @media only screen { pre { max-height: 66.6vh; overflow: auto; } }</style><style> .container { min-width: 66.6%; } @media only print { .container { min-width: 100%; } }</style><style> .container.content { padding: 2rem; box-shadow: 0 0 2rem rgba(255,255,255,0.9); background-color: rgba(255,255,255,0.9); animation-duration: 2s; animation-name: fadeIn; } @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }</style><div class="container content"><div class="page"><h1 class="page-title">ç¨ å¯†çŸ©é˜µç®—æ³•å®ç°</h1><div class="post"> <span class="post-date"> <i class="fas fa-calendar-day fa-fw"></i> 25 Oct 2019 <i class="fas fa-file-word fa-fw"></i> 17165å­— <i class="fas fa-clock fa-fw"></i> 58åˆ† <br/> <i class="fas fa-coffee fa-fw"></i> <a href="/merger/">å¦‚æœè¿™ç¯‡åšå®¢å¸®åŠ©åˆ°ä½ ï¼Œå¯ä»¥è¯·æˆ‘å–ä¸€æ¯å’–å•¡~</a> <br/> <i class="fab fa-creative-commons-by fa-fw"></i> <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="license"> CC BY 4.0 </a> ï¼ˆé™¤ç‰¹åˆ«å£°æ˜æˆ–è½¬è½½æ–‡ç« å¤–ï¼‰ </span><blockquote><p>çŸ©é˜µ$A$ï¼Œ$B$å’Œå‘é‡$\vec{x}$æŒ‰ä¸‹é¢å®šä¹‰å…ƒç´ ï¼š</p><ul><li>$a_{ij}=\frac{i-0.1\times j+1}{i+j+1}$<li>$b_{ij}=\frac{(j-0.2\times i+1)(i+j+1)}{i\times i+j\times j+1}$<li>$x_i=\frac{i}{i\times i+1}$</ul></blockquote><h2 id="å®ŒæˆçŸ©é˜µå‘é‡ä¹˜avecxçš„-mpi-å¹¶è¡Œç®—æ³•è¦æ±‚å¯¹çŸ©é˜µé‡‡ç”¨-2-ç»´åˆ’åˆ†">å®ŒæˆçŸ©é˜µå‘é‡ä¹˜$A\vec{x}$çš„ MPI å¹¶è¡Œç®—æ³•ï¼Œè¦æ±‚å¯¹çŸ©é˜µé‡‡ç”¨ 2 ç»´åˆ’åˆ†</h2><h3 id="åŸç†åˆ†æ">åŸç†åˆ†æ</h3><ul><li>æŠŠ$n\times n$çŸ©é˜µ$A$åœ¨$p$ï¼ˆ$p\le n^2$ï¼‰ä¸ªè¿›ç¨‹ä¸­åˆ’åˆ†ï¼Œ$p$ä¸ªè¿›ç¨‹ç»„æˆé˜µåˆ—$\sqrt{p}\times\sqrt{p}$ï¼ŒæŠŠ$n\times 1$å‘é‡$\vec{x}$åˆ†å¸ƒåœ¨ä¸ªè¿›ç¨‹é˜µåˆ—çš„æœ€åä¸€åˆ—<li>$p=n^2$<ul><li>æ¯ä¸ªè¿›ç¨‹æ‹¥æœ‰çŸ©é˜µ$A$çš„ä¸€ä¸ªå…ƒç´ ã€‚<li>æŠŠ$n\times 1$å‘é‡$\vec{x}$åˆ†å¸ƒåœ¨$n$ä¸ªè¿›ç¨‹çš„æœ€åä¸€åˆ—ã€‚</ul><li>$p&lt;n^2$<ul><li>æ¯ä¸ªè¿›ç¨‹$P_i$å‚¨å­˜çŸ©é˜µ$A$çš„å…·æœ‰$\frac{n}{\sqrt{p}}\times\frac{n}{\sqrt{p}}$é˜¶çš„å­çŸ©é˜µ$A_{i,j}$ã€‚<li>æœ€åä¸€åˆ—è¿›ç¨‹$P_i(i=\sqrt{p}âˆ’1,2\sqrt{p}âˆ’1,\dots,ğ‘âˆ’1)$å‚¨å­˜å‘é‡$\vec{x}$çš„$\frac{n}{\sqrt{p}}$ä¸ªå…ƒç´ $x_k$ã€‚</ul><li>äºŒç»´åˆ’åˆ†ç›¸æ¯”ä¸€ç»´æœ‰æ›´ä½çš„æ—¶é—´å¤æ‚åº¦å’Œæ›´å¥½çš„å¯æ‰©å±•æ€§ã€‚</ul><h3 id="æºä»£ç matvecmulc">æºä»£ç <code>MatVecMul.c</code></h3><pre><code class="language-c">#include &lt;stdlib.h&gt;
#include &lt;math.h&gt;
#include &lt;mpi.h&gt;
typedef double lf;
lf getA(int i, int j) { return (i - 0.1 * j + 1) / (i + j + 1); }
lf getB(int i, int j) { return (j - 0.2 * i + 1) * (i + j + 1) / (i * i + j * j + 1); }
lf getX(int i) { return i / (i * i + 1.0); }
int main(int argc, char **argv)
{
	MPI_Init(&amp;argc, &amp;argv);
	int comSize, comRank, n = 1 &lt;&lt; atoi(argv[1]);
	MPI_Comm_size(MPI_COMM_WORLD, &amp;comSize);
	MPI_Comm_rank(MPI_COMM_WORLD, &amp;comRank);
	int sqSize = round(sqrt(comSize)),	 //è¿›ç¨‹æ•°çš„å¼€æ–¹
		sqLen = (n + sqSize - 1) / sqSize, //æ¯ä¸ªè¿›ç¨‹åˆ†åˆ°çŸ©å½¢çš„è¾¹é•¿
		sqRow = comRank / sqSize,		   //æ¯ä¸ªè¿›ç¨‹åˆ†åˆ°çŸ©å½¢çš„è¡Œç¼–å·
		sqCol = comRank % sqSize;		   //æ¯ä¸ªè¿›ç¨‹åˆ†åˆ°çŸ©å½¢çš„åˆ—ç¼–å·
	MPI_Comm rowComm, colComm;			   //æŒ‰è¡Œå’Œåˆ—åˆ’åˆ†çš„é€šä¿¡åŸŸ
	MPI_Comm_split(MPI_COMM_WORLD, sqRow, sqCol, &amp;rowComm);
	MPI_Comm_split(MPI_COMM_WORLD, sqCol, sqRow, &amp;colComm);
	lf *x = (lf *)malloc(sizeof(lf) * sqLen),
	   *y = (lf *)malloc(sizeof(lf) * sqLen);
	if (!sqCol) //ç¬¬ä¸€ä¸ªé€šä¿¡æ­¥ï¼Œ0åˆ—çš„è¿›ç¨‹å„è‡ªè¯»å–å¾…æ±‚å‘é‡çš„ä¸€éƒ¨åˆ†ï¼Œå‘ç»™å¯¹è§’çº¿ä¸Šçš„è¿›ç¨‹
	{
		for (int i = 0; i &lt; sqLen; ++i)
			x[i] = getX(sqRow * sqLen + i);
		if (sqCol != sqRow) //é˜²æ­¢ä»…æœ‰ä¸€ä¸ªè¿›ç¨‹æ—¶å‘ç”Ÿè‡ªå·±å‘ç»™è‡ªå·±é€ æˆé˜»å¡
			MPI_Send(
				x,
				sqLen,
				MPI_DOUBLE,
				sqRow,
				1,
				rowComm);
	}
	else if (sqCol == sqRow) //å¯¹è§’çº¿ä¸Šï¼ˆä¸”ä¸åœ¨ç¬¬0åˆ—ï¼‰çš„æ¥å—
		MPI_Recv(
			x,
			sqLen,
			MPI_DOUBLE,
			0,
			1,
			rowComm,
			MPI_STATUSES_IGNORE);
	MPI_Bcast( //ç¬¬äºŒä¸ªé€šä¿¡æ­¥ï¼Œå¯¹è§’çº¿ä¸Šçš„è¿›ç¨‹å°†å‘é‡åˆ†ç»™åŒåˆ—çš„å…¶ä»–è¿›ç¨‹
		x,
		sqLen,
		MPI_DOUBLE,
		sqCol,
		colComm);
	for (int j = 0; j &lt; sqLen; ++j) //æ¯ä¸ªè¿›ç¨‹è®¡ç®—è‡ªå·±çš„çŸ©é˜µå’Œå‘é‡ç›¸ä¹˜çš„ç»“æœ
		for (int i = y[j] = 0; i &lt; sqLen; ++i)
			y[j] += getA(sqRow * sqLen + j, sqCol * sqLen + i) * x[i];
	MPI_Reduce( //ç¬¬äºŒä¸ªé€šä¿¡æ­¥ï¼Œå„è¿›ç¨‹å°†ç»“æœåŒæ­¥åˆ°ç¬¬0åˆ—
		y,
		x,
		sqLen,
		MPI_DOUBLE,
		MPI_SUM,
		0,
		rowComm);
	MPI_Finalize();
}
</code></pre><h3 id="è°ƒåº¦è„šæœ¬matvecmulpbs">è°ƒåº¦è„šæœ¬<code>MatVecMul.pbs</code></h3><p>è¿™é‡Œåªæ”¾å‡ºè¿è¡Œ 256 è¿›ç¨‹æ—¶çš„è°ƒåº¦è„šæœ¬ï¼Œå…¶ä»–åŒç†ã€‚</p><pre><code class="language-bash">#PBS -N MatVecMul
#PBS -l nodes=8:ppn=32
#PBS -j oe

source /public/software/profile.d/mpi_openmpi-intel-2.1.2.sh

mpicc $PBS_O_WORKDIR/MatVecMul.c -o $PBS_O_WORKDIR/MatVecMul -std=c11 -lm
for logN in 6 7 8 9 10 11 12 13 14 15 16 17
do
time mpiexec -machinefile $PBS_NODEFILE $PBS_O_WORKDIR/MatVecMul $logN
done
</code></pre><h3 id="è®¡ç®—ç®—æ³•çš„è¿è¡Œæ—¶é—´å¡«è¡¨">è®¡ç®—ç®—æ³•çš„è¿è¡Œæ—¶é—´ï¼Œå¡«è¡¨</h3><p>ç”±äºè¦æ±‚çŸ©é˜µäºŒç»´åˆ†åˆ’ï¼Œä¸ºæ–¹ä¾¿å¹¶è¡Œçš„è¿›ç¨‹æ•°å–å¹³æ–¹æ•°ã€‚</p><p>è¯¦è§é™„ä»¶ä¸­çš„<code>MatVecMul.o6610</code>~<code>MatVecMul.o6614</code>ï¼Œåˆ†åˆ«å¯¹åº”äº†è¿›ç¨‹æ•° 256ã€64ã€16ã€4ã€1 çš„è¿è¡Œæ—¶é—´ã€‚</p><p>å¯ä»¥çœ‹åˆ°ï¼Œç”±äºçŸ©é˜µå‘é‡ä¹˜çš„æ—¶é—´å¤æ‚åº¦æ˜¯$O(n^2)$çš„ï¼ŒæŒ‰ç…§ç°ä»£è®¡ç®—æœºå•æ ¸<code>1e9</code>æ¬¡æ¯ç§’çš„è¿ç®—é€Ÿåº¦æ¥è®¡ç®—çš„è¯ï¼Œé™¤äº†è¿›ç¨‹æ•°æœ€å°ä¸”é—®é¢˜è§„æ¨¡æœ€å¤§çš„æ—¶å€™è·‘äº†<code>15.105s</code>ï¼Œå…¶ä»–å¤§éƒ¨åˆ†éƒ½åœ¨<code>1s</code>ä¸Šä¸‹ï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯å¹¶è¡Œçš„é¢å¤–å¼€é”€ã€‚è€Œä¸”å¯ä»¥çœ‹åˆ°è¿™ä¸ªé¢å¤–å¼€é”€éšç€è¿›ç¨‹æ•°é‡å¢åŠ è€Œå¢åŠ ï¼Œåœ¨è¿›ç¨‹æ•°$16\to 64$çš„æ—¶å€™æœ‰ä¸€ä¸ªæ¯”è¾ƒå¤§çš„å¢å¹…ï¼Œå› ä¸ºè¿™æ—¶å€™ä»å•æœº 16 æ ¸çš„é…ç½®æ¢æˆäº†åŒæœº 64 æ ¸ï¼Œé€šä¿¡å¼€é”€å¢åŠ äº†å¾ˆå¤šã€‚</p><h4 id="è¿è¡Œæ—¶é—´">è¿è¡Œæ—¶é—´</h4><table><thead><tr><th>é—®é¢˜è§„æ¨¡\è¿›ç¨‹æ•°<th>1<th>4<th>16<th>64<th>256<tbody><tr><td>$2^6$<td>0.378<td>0.480<td>0.548<td>1.005<td>1.397<tr><td>$2^7$<td>0.454<td>0.472<td>0.555<td>1.085<td>1.315<tr><td>$2^8$<td>0.432<td>0.464<td>0.542<td>1.037<td>1.292<tr><td>$2^9$<td>0.430<td>0.461<td>0.571<td>1.056<td>1.337<tr><td>$2^{10}$<td>0.425<td>0.431<td>0.521<td>1.023<td>1.268<tr><td>$2^{11}$<td>0.453<td>0.478<td>0.514<td>1.084<td>1.291<tr><td>$2^{12}$<td>0.469<td>0.494<td>0.510<td>1.049<td>1.306<tr><td>$2^{13}$<td>0.528<td>0.496<td>0.540<td>1.051<td>1.348<tr><td>$2^{14}$<td>0.690<td>0.562<td>0.559<td>1.052<td>1.287<tr><td>$2^{15}$<td>1.525<td>0.771<td>0.622<td>1.124<td>1.307<tr><td>$2^{16}$<td>4.215<td>1.554<td>0.881<td>1.146<td>1.326<tr><td>$2^{17}$<td>15.105<td>4.090<td>1.674<td>1.348<td>1.380</table><h4 id="åŠ é€Ÿæ¯”">åŠ é€Ÿæ¯”</h4><table><thead><tr><th>é—®é¢˜è§„æ¨¡\è¿›ç¨‹æ•°<th>1<th>4<th>16<th>64<th>256<tbody><tr><td>$2^6$<td>1<td>0.7875<td>0.689781022<td>0.376119403<td>0.270579814<tr><td>$2^7$<td>1<td>0.961864407<td>0.818018018<td>0.41843318<td>0.345247148<tr><td>$2^8$<td>1<td>0.931034483<td>0.79704797<td>0.416586307<td>0.334365325<tr><td>$2^9$<td>1<td>0.932754881<td>0.753064799<td>0.40719697<td>0.321615557<tr><td>$2^{10}$<td>1<td>0.986078886<td>0.815738964<td>0.41544477<td>0.335173502<tr><td>$2^{11}$<td>1<td>0.947698745<td>0.881322957<td>0.417896679<td>0.350890782<tr><td>$2^{12}$<td>1<td>0.949392713<td>0.919607843<td>0.447092469<td>0.359111792<tr><td>$2^{13}$<td>1<td>1.064516129<td>0.977777778<td>0.502378687<td>0.391691395<tr><td>$2^{14}$<td>1<td>1.227758007<td>1.234347048<td>0.655893536<td>0.536130536<tr><td>$2^{15}$<td>1<td>1.977950713<td>2.451768489<td>1.356761566<td>1.166794185<tr><td>$2^{16}$<td>1<td>2.712355212<td>4.784335982<td>3.678010471<td>3.178733032<tr><td>$2^{17}$<td>1<td>3.693154034<td>9.023297491<td>11.20548961<td>10.94565217</table><h4 id="è¿ç®—æ•ˆç‡">è¿ç®—æ•ˆç‡</h4><table><thead><tr><th>é—®é¢˜è§„æ¨¡\è¿›ç¨‹æ•°<th>1<th>4<th>16<th>64<th>256<tbody><tr><td>$2^6$<td>1<td>0.196875<td>0.043111314<td>0.005876866<td>0.001056952<tr><td>$2^7$<td>1<td>0.240466102<td>0.051126126<td>0.006538018<td>0.001348622<tr><td>$2^8$<td>1<td>0.232758621<td>0.049815498<td>0.006509161<td>0.001306115<tr><td>$2^9$<td>1<td>0.23318872<td>0.04706655<td>0.006362453<td>0.001256311<tr><td>$2^{10}$<td>1<td>0.246519722<td>0.050983685<td>0.006491325<td>0.001309271<tr><td>$2^{11}$<td>1<td>0.236924686<td>0.055082685<td>0.006529636<td>0.001370667<tr><td>$2^{12}$<td>1<td>0.237348178<td>0.05747549<td>0.00698582<td>0.00140278<tr><td>$2^{13}$<td>1<td><strong>0.266129032</strong><td>0.061111111<td>0.007849667<td>0.001530045<tr><td>$2^{14}$<td>1<td>0.306939502<td>0.077146691<td>0.010248337<td>0.00209426<tr><td>$2^{15}$<td>1<td>0.494487678<td><strong>0.153235531</strong><td>0.021199399<td>0.00455779<tr><td>$2^{16}$<td>1<td>0.678088803<td>0.299020999<td>0.057468914<td>0.012416926<tr><td>$2^{17}$<td>1<td>0.923288509<td>0.563956093<td><strong>0.175085775</strong><td>0.042756454</table><h4 id="éªŒè¯ç­‰æ•ˆç‡å‡½æ•°">éªŒè¯ç­‰æ•ˆç‡å‡½æ•°</h4><p>è§ã€Œè¿ç®—æ•ˆç‡ã€ä¸­æ ‡é»‘éƒ¨åˆ†ã€‚</p><p>ç”±äºå¹¶è¡Œå¼€é”€è¾ƒå¤§è€Œè®¡ç®—é‡å°ï¼Œè¿™åªå–é—®é¢˜è§„æ¨¡è¾ƒå¤§çš„éƒ¨åˆ†åšä¸€ä¸‹éªŒè¯ã€‚ä¸è€ƒè™‘å¹¶è¡ŒåŒæ­¥å¼€é”€æ—¶$W(n)=\frac{n^2}{p^2}$ï¼Œå› æ­¤è§„æ¨¡è¾ƒå¤§çš„æ—¶å€™è¦ä¿æŒ Eï¼Œåˆ™ n ä¸ p å‘ˆçº¿æ€§å…³ç³»ã€‚</p><h2 id="ç®€å•çŸ©é˜µä¹˜æ³•cabçŸ©é˜µé‡‡ç”¨-2-ç»´åˆ’åˆ†">ç®€å•çŸ©é˜µä¹˜æ³•$C=AB$ï¼ˆçŸ©é˜µé‡‡ç”¨ 2 ç»´åˆ’åˆ†ï¼‰</h2><h3 id="åŸç†åˆ†æ-1">åŸç†åˆ†æ</h3><ul><li>è€ƒè™‘ä¸¤ä¸ª$n\times n$çŸ©é˜µ$A$å’Œ$B$ï¼Œåˆ†åˆ«åˆ’åˆ†æˆ$p$ä¸ªå¤§å°ä¸º$\frac{n}{\sqrt{p}}\times\frac{n}{\sqrt{p}}$çš„å—$A_{i,j}$å’Œ$B_{i,j}$ã€‚<li>è¿›ç¨‹$P_{i,j}$æœ€åˆå‚¨å­˜$A_{i,j}$å’Œ$B_{i,j}$ï¼Œå¹¶è®¡ç®—ç»“æœçŸ©é˜µçš„å—$C_{i,j}$ã€‚<li>è®¡ç®—å­çŸ©é˜µ$C_{i,j}$éœ€è¦æ‰€æœ‰å­çŸ©é˜µ$A_{i,k}$å’Œ$B_{k,j}$ï¼ˆ$0\le k\le\sqrt{p}$ï¼‰ã€‚<li>æ¯è¡Œè¿›è¡ŒçŸ©é˜µ$A$çš„å—çš„å…¨æ”¶é›†é€šä¿¡ï¼ŒåŒæ—¶æ¯åˆ—è¿›è¡ŒçŸ©é˜µ$B$çš„å—çš„å…¨æ”¶é›†é€šä¿¡ã€‚<li>æœ€åæ‰§è¡Œå­çŸ©é˜µçš„ä¹˜åŠ è¿ç®—ã€‚</ul><h3 id="æºä»£ç matmatmulc">æºä»£ç <code>MatMatMul.c</code></h3><pre><code class="language-c">#include &lt;stdlib.h&gt;
#include &lt;math.h&gt;
#include &lt;mpi.h&gt;
typedef double lf;
lf getA(int i, int j) { return (i - 0.1 * j + 1) / (i + j + 1); }
lf getB(int i, int j) { return (j - 0.2 * i + 1) * (i + j + 1) / (i * i + j * j + 1); }
lf getX(int i) { return i / (i * i + 1.0); }
int main(int argc, char **argv)
{
	MPI_Init(&amp;argc, &amp;argv);
	int comSize, comRank, n = 1 &lt;&lt; atoi(argv[1]);
	MPI_Comm_size(MPI_COMM_WORLD, &amp;comSize);
	MPI_Comm_rank(MPI_COMM_WORLD, &amp;comRank);
	int sqSize = round(sqrt(comSize)),	 //è¿›ç¨‹æ•°çš„å¼€æ–¹
		sqLen = (n + sqSize - 1) / sqSize, //æ¯ä¸ªè¿›ç¨‹åˆ†åˆ°çŸ©å½¢çš„è¾¹é•¿
		sqRow = comRank / sqSize,		   //æ¯ä¸ªè¿›ç¨‹åˆ†åˆ°çŸ©å½¢çš„è¡Œç¼–å·
		sqCol = comRank % sqSize;		   //æ¯ä¸ªè¿›ç¨‹åˆ†åˆ°çŸ©å½¢çš„åˆ—ç¼–å·
	MPI_Comm rowComm, colComm;			   //æŒ‰è¡Œå’Œåˆ—åˆ’åˆ†çš„é€šä¿¡åŸŸ
	MPI_Comm_split(MPI_COMM_WORLD, sqRow, sqCol, &amp;rowComm);
	MPI_Comm_split(MPI_COMM_WORLD, sqCol, sqRow, &amp;colComm);
	lf *c = (lf *)malloc(sizeof(lf) * sqLen * sqLen),
	   *ra = (lf *)malloc(sizeof(lf) * sqLen * sqLen),
	   *rb = (lf *)malloc(sizeof(lf) * sqLen * sqLen);
	for (int i = 0; i &lt; sqLen; ++i)
		for (int j = 0; j &lt; sqLen; ++j)
			c[i * sqLen + j] = getA(sqRow * sqLen + i, sqCol * sqLen + j);
	MPI_Alltoall( //æŒ‰è¡Œåˆ†å‘a
		c,
		sqLen * sqLen / sqSize,
		MPI_DOUBLE,
		ra,
		sqLen * sqLen / sqSize,
		MPI_DOUBLE,
		rowComm);
	for (int i = 0; i &lt; sqLen; ++i)
		for (int j = 0; j &lt; sqLen; ++j)
			c[j * sqLen + i] = getB(sqRow * sqLen + i, sqCol * sqLen + j); //ä¿å­˜çš„æ˜¯bçš„è½¬ç½®
	MPI_Alltoall(														   //æŒ‰åˆ—åˆ†å‘bï¼ˆè½¬ç½®ï¼‰
		c,
		sqLen * sqLen / sqSize,
		MPI_DOUBLE,
		rb,
		sqLen * sqLen / sqSize,
		MPI_DOUBLE,
		colComm);
	for (int i = 0; i &lt; sqLen; ++i)
		for (int j = 0; j &lt; sqLen; ++j)
			for (int k = c[i * sqLen + j] = 0; k &lt; sqLen; ++k)
				c[i * sqLen + j] += ra[i * sqLen + k] * rb[j * sqLen + k]; //bä¸­æ˜¯è½¬ç½®
	free(c), free(ra), free(rb);
	MPI_Finalize();
}
</code></pre><h3 id="è°ƒåº¦è„šæœ¬matmatmulpbs">è°ƒåº¦è„šæœ¬<code>MatMatMul.pbs</code></h3><pre><code class="language-c">#PBS -N MatMatMul
#PBS -l nodes=8:ppn=32
#PBS -j oe

source /public/software/profile.d/mpi_openmpi-intel-2.1.2.sh

mpicc $PBS_O_WORKDIR/MatMatMul.c -o $PBS_O_WORKDIR/MatMatMul -std=c11 -lm
for logN in 6 7 8 9 10 11 12 13 14 15 16 17
do
time mpiexec -machinefile $PBS_NODEFILE $PBS_O_WORKDIR/MatMatMul $logN
done
</code></pre><h3 id="è®¡ç®—ç®—æ³•çš„è¿è¡Œæ—¶é—´å¡«è¡¨-1">è®¡ç®—ç®—æ³•çš„è¿è¡Œæ—¶é—´ï¼Œå¡«è¡¨</h3><p><strong>ç”±äºè¦æ±‚çŸ©é˜µäºŒç»´åˆ†åˆ’ï¼Œå› æ­¤å¹¶è¡Œçš„è¿›ç¨‹æ•°å¿…é¡»æ˜¯å¹³æ–¹æ•°ã€‚</strong></p><p>è¯¦è§é™„ä»¶ä¸­çš„<code>MatMatMul.o6633</code>~<code>MatMatMul.o6638</code>ï¼Œåˆ†åˆ«å¯¹åº”äº†è¿›ç¨‹æ•° 256ã€64ã€16ã€4ã€1 çš„è¿è¡Œæ—¶é—´ã€‚ä¸‹è¡¨ä¸­çš„<code>x</code>ä»£è¡¨æ²¡æœ‰åœ¨é™å®šæ—¶é—´ä¸­æ±‚è§£å®Œæ¯•ã€‚</p><p>å¯ä»¥çœ‹åˆ°ï¼Œç”±äºçŸ©é˜µå‘é‡ä¹˜çš„æ—¶é—´å¤æ‚åº¦æ˜¯$O(n^3)$çš„ï¼ŒæŒ‰ç…§å•æ ¸<code>1e9</code>æ¬¡æ¯ç§’çš„è¿ç®—é€Ÿåº¦æ¥è®¡ç®—çš„è¯ï¼Œé—®é¢˜è§„æ¨¡ç¨å¤§ä¸€ç‚¹çš„æ—¶å€™ï¼Œåœ¨ä¸€ä¸ªä½œä¸šè„šæœ¬çš„ä¸€ä¸ªå°æ—¶é™åˆ¶å†…åŸºæœ¬ä¸Šæ˜¯è·‘ä¸å®Œçš„ã€‚å½“ç„¶ï¼Œå¯ä»¥çœ‹åˆ°è¿™é‡ŒåŒé—®é¢˜è§„æ¨¡ä¸”è¶³å¤Ÿå¤§çš„æ—¶å€™ï¼Œè¿è¡Œæ—¶é—´ä¼šéšè¿›ç¨‹æ•°å¢åŠ è€Œå‡å°‘ï¼Œå¹¶è¡ŒåŒ–å–å¾—äº†ä¸€å®šçš„åŠ é€Ÿç»“æœã€‚</p><h4 id="è¿è¡Œæ—¶é—´-1">è¿è¡Œæ—¶é—´</h4><table><thead><tr><th>é—®é¢˜è§„æ¨¡\è¿›ç¨‹æ•°<th>1<th>4<th>16<th>64<th>256<tbody><tr><td>$2^6$<td>0.543<td>0.448<td>0.587<td>1.245<td>1.407<tr><td>$2^7$<td>0.496<td>0.433<td>0.572<td>1.165<td>1.407<tr><td>$2^8$<td>0.530<td>0.477<td>0.575<td>1.136<td>1.375<tr><td>$2^9$<td>0.520<td>0.507<td>0.562<td>1.181<td>1.597<tr><td>$2^{10}$<td>1.208<td>0.539<td>0.569<td>1.096<td>1.664<tr><td>$2^{11}$<td>7.368<td>1.140<td>0.685<td>1.151<td>1.665<tr><td>$2^{12}$<td>61.114<td>7.279<td>1.473<td>1.223<td>1.657<tr><td>$2^{13}$<td>481.676<td>61.072<td>7.449<td>2.231<td>1.712<tr><td>$2^{14}$<td>x<td>485.722<td>60.931<td>11.028<td>3.106<tr><td>$2^{15}$<td>x<td>x<td>487.180<td>80.777<td>15.511<tr><td>$2^{16}$<td>x<td>x<td>x<td>636.016<td>111.355<tr><td>$2^{17}$<td>x<td>x<td>x<td>x<td>875.914</table><h4 id="åŠ é€Ÿæ¯”-1">åŠ é€Ÿæ¯”</h4><table><thead><tr><th>é—®é¢˜è§„æ¨¡\è¿›ç¨‹æ•°<th>1<th>4<th>16<th>64<th>256<tbody><tr><td>$2^6$<td>1<td>1.212053571<td>0.925042589<td>0.436144578<td>0.385927505<tr><td>$2^7$<td>1<td>1.145496536<td>0.867132867<td>0.425751073<td>0.352523099<tr><td>$2^8$<td>1<td>1.111111111<td>0.92173913<td>0.466549296<td>0.385454545<tr><td>$2^9$<td>1<td>1.025641026<td>0.925266904<td>0.440304826<td>0.32561052<tr><td>$2^{10}$<td>1<td>2.241187384<td>2.123022847<td>1.102189781<td>0.725961538<tr><td>$2^{11}$<td>1<td>6.463157895<td>10.75620438<td>6.401390096<td>4.425225225<tr><td>$2^{12}$<td>1<td>8.395933507<td>41.48947726<td>49.97056419<td>36.88231744<tr><td>$2^{13}$<td>1<td>7.887018601<td>64.66317627<td>215.9013895<td>281.3528037<tr><td>$2^{14}$<td>x<td>x<td>x<td>x<td>x<tr><td>$2^{15}$<td>x<td>x<td>x<td>x<td>x<tr><td>$2^{16}$<td>x<td>x<td>x<td>x<td>x<tr><td>$2^{17}$<td>x<td>x<td>x<td>x<td>x</table><h4 id="è¿ç®—æ•ˆç‡-1">è¿ç®—æ•ˆç‡</h4><table><thead><tr><th>é—®é¢˜è§„æ¨¡\è¿›ç¨‹æ•°<th>1<th>4<th>16<th>64<th>256<tbody><tr><td>$2^6$<td>1<td>0.303013393<td>0.057815162<td>0.006814759<td>0.001507529<tr><td>$2^7$<td>1<td>0.286374134<td>0.054195804<td>0.006652361<td>0.001377043<tr><td>$2^8$<td>1<td><strong>0.277777778</strong><td>0.057608696<td>0.007289833<td>0.001505682<tr><td>$2^9$<td>1<td>0.256410256<td>0.057829181<td>0.006879763<td>0.001271916<tr><td>$2^{10}$<td>1<td>0.560296846<td>0.132688928<td>0.017221715<td>0.002835787<tr><td>$2^{11}$<td>1<td>1.615789474<td>0.672262774<td>0.10002172<td>0.017286036<tr><td>$2^{12}$<td>1<td>2.098983377<td>2.593092329<td>0.780790065<td><strong>0.144071553</strong><tr><td>$2^{13}$<td>1<td>1.97175465<td>4.041448517<td>3.373459211<td>1.09903439<tr><td>$2^{14}$<td>x<td>x<td>x<td>x<td>x<tr><td>$2^{15}$<td>x<td>x<td>x<td>x<td>x<tr><td>$2^{16}$<td>x<td>x<td>x<td>x<td>x<tr><td>$2^{17}$<td>x<td>x<td>x<td>x<td>x</table><h4 id="éªŒè¯ç­‰æ•ˆç‡å‡½æ•°-1">éªŒè¯ç­‰æ•ˆç‡å‡½æ•°</h4><p>ä¸è€ƒè™‘å¹¶è¡Œå¼€é”€æ—¶ï¼ˆæ ¹æ®å¤æ–¯å¡”å¤«æ£®å®šå¾‹ï¼Œé—®é¢˜è§„æ¨¡å¤§çš„æ—¶å€™å¯å¿½ç•¥ï¼‰ï¼Œç­‰æ•ˆç‡å‡½æ•°$W(n)=\frac{n^3}{p^2}$ï¼Œå³$n\to p^{\frac{2}{3}}$ã€‚è§ã€Œè¿ç®—æ•ˆç‡ã€ä¸­æ ‡é»‘éƒ¨åˆ†ï¼ˆè¿›ç¨‹æ•°å¢åŠ äº† 64 å€ï¼Œé—®é¢˜è§„æ¨¡å¢åŠ  16 å€ï¼Œè¿ç®—æ•ˆç‡å¤„äºåŒä¸€ä¸ªæ•°é‡çº§ï¼‰ã€‚</p><h2 id="çŸ©é˜µä¹˜æ³•cabçš„-cannon-ç®—æ³•">çŸ©é˜µä¹˜æ³•$C=AB$çš„ CANNON ç®—æ³•</h2><h3 id="åŸç†åˆ†æ-2">åŸç†åˆ†æ</h3><ul><li>æœ€åˆå­çŸ©é˜µ$A_{i,j}$å’Œ$B_{i,j}$åˆ†é…ç»™è¿›ç¨‹$P_{i,j}$ã€‚<li>æˆ‘ä»¬è°ƒåº¦ç¬¬$i$è¡Œ$\sqrt{p}$ä¸ªè¿›ç¨‹çš„è®¡ç®—ï¼Œä½¿å¾—æ¯ä¸ªè¿›ç¨‹åœ¨ä¸åŒæ—¶åˆ»ä½¿ç”¨ä¸åŒçš„$A_{i,k}$ã€‚<li>æ¯å®Œæˆä¸€æ¬¡å­çŸ©é˜µä¹˜æ³•ï¼Œè¿™äº›å—åœ¨å„è¿›ç¨‹ä¹‹é—´è¿›è¡Œä¸€æ¬¡ç§»ä½ï¼Œä½¿å¾—æ¯ä¸ªè¿›ç¨‹è·å¾—ä¸‹ä¸€æ­¥éœ€è¦çš„æ–°çš„$A_{i,k}$ã€‚<li>å¯¹åˆ—ä½¿ç”¨åŒæ ·çš„è°ƒåº¦ã€‚<li>è¯¥ç®—æ³•éœ€è¦çš„å†…å­˜æ€»é‡ä¸º$O(n^2)$ã€‚<li>Cannon ç®—æ³•çš„æˆæœ¬æœ€ä¼˜æ¡ä»¶å’Œç­‰æ•ˆç‡å‡½æ•°ä¸å‰é¢æåˆ°çš„ç®€å•æ–¹æ³•ä¸€è‡´ï¼Œä½†æ›´èŠ‚çœç©ºé—´ã€‚</ul><h3 id="æºä»£ç cannonc">æºä»£ç <code>Cannon.c</code></h3><pre><code class="language-c">#include &lt;stdlib.h&gt;
#include &lt;math.h&gt;
#include &lt;mpi.h&gt;
typedef double lf;
lf getA(int i, int j) { return (i - 0.1 * j + 1) / (i + j + 1); }
lf getB(int i, int j) { return (j - 0.2 * i + 1) * (i + j + 1) / (i * i + j * j + 1); }
lf getX(int i) { return i / (i * i + 1.0); }
int main(int argc, char **argv)
{
	MPI_Init(&amp;argc, &amp;argv);
	int comSize, comRank;
	MPI_Comm_size(MPI_COMM_WORLD, &amp;comSize);
	MPI_Comm_rank(MPI_COMM_WORLD, &amp;comRank);

	int dims[2] = {round(sqrt(comSize)), round(sqrt(comSize))}, //è¿›ç¨‹çŸ©é˜µé•¿å®½
		periods[2] = {1, 1},
		n = 1 &lt;&lt; atoi(argv[1]), //çŸ©é˜µé˜¶æ•°
		sqLen = n / dims[0],	//æ¯ä¸ªè¿›ç¨‹åˆ†é…çŸ©é˜µé•¿åº¦
		sqRank,
		sqCoord[2];

	MPI_Comm cartComm;
	MPI_Cart_create( //åˆ›å»ºç¬›å¡å°”æ‹“æ‰‘
		MPI_COMM_WORLD,
		2,
		dims,
		periods, //æ¯ä¸ªç»´åº¦ä¸Šå¾ªç¯
		0,
		&amp;cartComm);
	MPI_Comm_rank(cartComm, &amp;sqRank); //è·å¾—ç¬›å¡å°”æ‹“æ‰‘ä¸‹çš„ç¼–å·
	MPI_Cart_coords(				  //è·å¾—ç¬›å¡å°”åæ ‡
		cartComm,
		sqRank,
		2,
		sqCoord);

	lf *a = (lf *)malloc(sqLen * sqLen * sizeof(lf)),
	   *b = (lf *)malloc(sqLen * sqLen * sizeof(lf)),
	   *c = (lf *)malloc(sqLen * sqLen * sizeof(lf));

	for (int i = 0; i &lt; sqLen; ++i)
		for (int j = 0; j &lt; sqLen; ++j)
		{ // åˆå§‹åŒ–çŸ©é˜µå†…å®¹
			a[i * sqLen + j] = getA(sqCoord[0] * sqLen + i, sqCoord[1] * sqLen + j);
			b[i * sqLen + j] = getB(sqCoord[0] * sqLen + i, sqCoord[1] * sqLen + j);
			c[i * sqLen + j] = 0;
		}

	int shiftsource, shiftdest;
	MPI_Cart_shift( // å°†aã€båˆ†å‘ç»™ç›¸åº”è¿›ç¨‹
		cartComm,
		0,
		-sqCoord[1],
		&amp;shiftsource,
		&amp;shiftdest);
	MPI_Sendrecv_replace(
		a,
		sqLen * sqLen,
		MPI_DOUBLE,
		shiftdest,
		1,
		shiftsource,
		1,
		cartComm,
		MPI_STATUSES_IGNORE);
	MPI_Cart_shift(
		cartComm,
		1,
		-sqCoord[0],
		&amp;shiftsource,
		&amp;shiftdest);
	MPI_Sendrecv_replace(
		b,
		sqLen * sqLen,
		MPI_DOUBLE,
		shiftdest,
		1,
		shiftsource,
		1,
		cartComm,
		MPI_STATUSES_IGNORE);

	int uRank, dRank, lRank, rRank; //ä¸Šä¸‹å·¦å³ï¼Œå…¶ä¸­å³ã€ä¸‹ä¸ºæº
	MPI_Cart_shift(
		cartComm,
		0,
		-1,
		&amp;rRank,
		&amp;lRank);
	MPI_Cart_shift(
		cartComm,
		1,
		-1,
		&amp;dRank,
		&amp;uRank);

	for (int i = 0; i &lt; dims[0]; ++i)
	{
		for (int i = 0; i &lt; sqLen; ++i) //æœ¬åœ°ä¹˜åŠ 
			for (int j = 0; j &lt; sqLen; ++j)
				for (int k = 0; k &lt; sqLen; ++k)
					c[i * sqLen + j] += a[i * sqLen + k] * b[k * sqLen + j];
		MPI_Sendrecv_replace(
			a,
			sqLen * sqLen,
			MPI_DOUBLE,
			lRank,
			1,
			rRank,
			1,
			cartComm,
			MPI_STATUSES_IGNORE);
		MPI_Sendrecv_replace(
			b,
			sqLen * sqLen,
			MPI_DOUBLE,
			uRank,
			1,
			dRank,
			1,
			cartComm,
			MPI_STATUSES_IGNORE);
	}

	MPI_Cart_shift( // ä»ç›¸åº”è¿›ç¨‹å¤„æ¢å¤å‘é€çš„aã€bå­å—
		cartComm,
		0,
		-sqCoord[1],
		&amp;shiftsource,
		&amp;shiftdest);
	MPI_Sendrecv_replace(
		a,
		sqLen * sqLen,
		MPI_DOUBLE,
		shiftdest,
		1,
		shiftsource,
		1,
		cartComm,
		MPI_STATUSES_IGNORE);
	MPI_Cart_shift(
		cartComm,
		1,
		-sqCoord[0],
		&amp;shiftsource,
		&amp;shiftdest);
	MPI_Sendrecv_replace(
		b,
		sqLen * sqLen,
		MPI_DOUBLE,
		shiftdest,
		1,
		shiftsource,
		1,
		cartComm,
		MPI_STATUSES_IGNORE);
	free(a), free(b), free(c);
	MPI_Comm_free(&amp;cartComm);
	MPI_Finalize();
}
</code></pre><h3 id="è°ƒåº¦è„šæœ¬cannonpbs">è°ƒåº¦è„šæœ¬<code>Cannon.pbs</code></h3><p>è¿™é‡Œåªæ”¾å‡ºè¿è¡Œ 256 è¿›ç¨‹æ—¶çš„è°ƒåº¦è„šæœ¬ï¼Œå…¶ä»–åŒç†ã€‚</p><pre><code class="language-bash">#PBS -N Cannon
#PBS -l nodes=8:ppn=32
#PBS -j oe

source /public/software/profile.d/mpi_openmpi-intel-2.1.2.sh

mpicc $PBS_O_WORKDIR/Cannon.c -o $PBS_O_WORKDIR/Cannon -std=c11 -lm
for logN in 6 7 8 9 10 11 12 13 14 15 16 17
do
time mpiexec -machinefile $PBS_NODEFILE $PBS_O_WORKDIR/Cannon $logN
done
</code></pre><h3 id="è®¡ç®—ç®—æ³•çš„è¿è¡Œæ—¶é—´å¡«è¡¨-2">è®¡ç®—ç®—æ³•çš„è¿è¡Œæ—¶é—´ï¼Œå¡«è¡¨</h3><p><strong>ç”±äºè¦æ±‚çŸ©é˜µäºŒç»´åˆ†åˆ’ï¼Œå› æ­¤å¹¶è¡Œçš„è¿›ç¨‹æ•°å¿…é¡»æ˜¯å¹³æ–¹æ•°ã€‚</strong></p><p>è¯¦è§é™„ä»¶ä¸­çš„<code>Cannon.o6645</code>~<code>Cannon.o6649</code>ï¼Œåˆ†åˆ«å¯¹åº”äº†è¿›ç¨‹æ•° 256ã€64ã€16ã€4ã€1 çš„è¿è¡Œæ—¶é—´ã€‚ä¸‹è¡¨ä¸­çš„<code>x</code>ä»£è¡¨æ²¡æœ‰åœ¨é™å®šæ—¶é—´ä¸­æ±‚è§£å®Œæ¯•ã€‚</p><p>ç”±äº Cannon ç®—æ³•ç›¸å¯¹äºç®€å•å¹¶è¡ŒçŸ©é˜µä¹˜æ³•ç›¸æ¯”å‡å°‘çš„åªæ˜¯ç©ºé—´å ç”¨ï¼Œæ—¶é—´å¤æ‚åº¦æ²¡æœ‰æ”¹å˜ï¼Œå¹¶ä¸”ç”±äºç®—æ³•å˜å¾—æ›´åŠ å¤æ‚ï¼Œæ—¶é—´å¸¸æ•°å˜çš„æ¯”è¾ƒå¤§ï¼Œå½“é—®é¢˜è§„æ¨¡è¾¾åˆ°$2^{17}$çš„æ—¶å€™å‡ä¸èƒ½åœ¨è§„å®šæ—¶é—´å†…è®¡ç®—å‡ºç»“æœã€‚å…¶ä»–æƒ…å†µä¸‹çš„è¿è¡Œç»“æœå’Œç®€å•çŸ©é˜µä¹˜æ³•ç±»ä¼¼ï¼Œä¸å†èµ˜è¿°ã€‚</p><h3 id="è¿è¡Œæ—¶é—´-2">è¿è¡Œæ—¶é—´</h3><table><thead><tr><th>é—®é¢˜è§„æ¨¡\è¿›ç¨‹æ•°<th>1<th>4<th>16<th>64<th>256<tbody><tr><td>$2^6$<td>0.499<td>0.476<td>0.791<td>1.600<td>1.794<tr><td>$2^7$<td>0.457<td>0.452<td>0.583<td>1.167<td>1.415<tr><td>$2^8$<td>0.491<td>0.483<td>0.563<td>1.171<td>1.347<tr><td>$2^9$<td>0.580<td>0.562<td>0.496<td>1.142<td>1.347<tr><td>$2^{10}$<td>1.143<td>0.744<td>0.640<td>1.027<td>1.339<tr><td>$2^{11}$<td>8.048<td>1.846<td>0.883<td>1.144<td>1.394<tr><td>$2^{12}$<td>61.985<td>15.506<td>4.000<td>1.801<td>1.495<tr><td>$2^{13}$<td>490.234<td>124.022<td>30.130<td>10.659<td>2.781<tr><td>$2^{14}$<td>x<td>980.345<td>247.967<td>81.121<td>25.447<tr><td>$2^{15}$<td>x<td>x<td>1972.293<td>648.052<td>217.948<tr><td>$2^{16}$<td>x<td>x<td>x<td>x<td>1751.185<tr><td>$2^{17}$<td>x<td>x<td>x<td>x<td>x</table><h3 id="åŠ é€Ÿæ¯”-2">åŠ é€Ÿæ¯”</h3><table><thead><tr><th>é—®é¢˜è§„æ¨¡\è¿›ç¨‹æ•°<th>1<th>4<th>16<th>64<th>256<tbody><tr><td>$2^6$<td>1<td>1.048319328<td>0.630847029<td>0.311875<td>0.278149387<tr><td>$2^7$<td>1<td>1.011061947<td>0.783876501<td>0.391602399<td>0.322968198<tr><td>$2^8$<td>1<td>1.016563147<td>0.872113677<td>0.419299744<td>0.364513734<tr><td>$2^9$<td>1<td>1.03202847<td>1.169354839<td>0.507880911<td>0.430586488<tr><td>$2^{10}$<td>1<td>1.536290323<td>1.7859375<td>1.112950341<td>0.853622106<tr><td>$2^{11}$<td>1<td>4.359696641<td>9.114382786<td>7.034965035<td>5.773314204<tr><td>$2^{12}$<td>1<td>3.997484845<td>15.49625<td>34.41699056<td>41.46153846<tr><td>$2^{13}$<td>1<td>3.952798697<td>16.27062728<td>45.99249461<td>176.2797555<tr><td>$2^{14}$<td>x<td>x<td>x<td>x<td>x<tr><td>$2^{15}$<td>x<td>x<td>x<td>x<td>x<tr><td>$2^{16}$<td>x<td>x<td>x<td>x<td>x<tr><td>$2^{17}$<td>x<td>x<td>x<td>x<td>x</table><h4 id="è¿è¡Œæ•ˆç‡">è¿è¡Œæ•ˆç‡</h4><table><thead><tr><th>é—®é¢˜è§„æ¨¡\è¿›ç¨‹æ•°<th>1<th>4<th>16<th>64<th>256<tbody><tr><td>$2^6$<td>1<td>0.262079832<td>0.039427939<td>0.004873047<td>0.001086521<tr><td>$2^7$<td>1<td>0.252765487<td>0.048992281<td>0.006118787<td>0.001261595<tr><td>$2^8$<td>1<td>0.254140787<td>0.054507105<td>0.006551558<td>0.001423882<tr><td>$2^9$<td>1<td><strong>0.258007117</strong><td>0.073084677<td>0.007935639<td>0.001681978<tr><td>$2^{10}$<td>1<td>0.384072581<td>0.111621094<td>0.017389849<td>0.003334461<tr><td>$2^{11}$<td>1<td>1.08992416<td>0.569648924<td>0.109921329<td>0.022552009<tr><td>$2^{12}$<td>1<td>0.999371211<td>0.968515625<td>0.537765478<td>0.161959135<tr><td>$2^{13}$<td>1<td>0.988199674<td>1.016914205<td>0.718632728<td><strong>0.688592795</strong><tr><td>$2^{14}$<td>x<td>x<td>x<td>x<td>x<tr><td>$2^{15}$<td>x<td>x<td>x<td>x<td>x<tr><td>$2^{16}$<td>x<td>x<td>x<td>x<td>x<tr><td>$2^{17}$<td>x<td>x<td>x<td>x<td>x</table><h4 id="éªŒè¯ç­‰æ•ˆç‡æ¨¡å‹">éªŒè¯ç­‰æ•ˆç‡æ¨¡å‹</h4><p>ä¸è€ƒè™‘å¹¶è¡Œå¼€é”€æ—¶ï¼ˆæ ¹æ®å¤æ–¯å¡”å¤«æ£®å®šå¾‹ï¼Œé—®é¢˜è§„æ¨¡å¤§çš„æ—¶å€™å¯å¿½ç•¥ï¼‰ï¼Œç­‰æ•ˆç‡å‡½æ•°$W(n)=\frac{n^3}{p^2}$ï¼Œå³$n\to p^{\frac{2}{3}}$ã€‚è§ã€Œè¿ç®—æ•ˆç‡ã€ä¸­æ ‡é»‘éƒ¨åˆ†ï¼ˆè¿›ç¨‹æ•°å¢åŠ äº† 64 å€ï¼Œé—®é¢˜è§„æ¨¡å¢åŠ  16 å€ï¼Œè¿ç®—æ•ˆç‡å¤„äºåŒä¸€ä¸ªæ•°é‡çº§ï¼‰ã€‚</p><h2 id="çŸ©é˜µä¹˜æ³•cabçš„-dns-ç®—æ³•">çŸ©é˜µä¹˜æ³•$C=AB$çš„ DNS ç®—æ³•</h2><h3 id="åŸç†åˆ†æ-3">åŸç†åˆ†æ</h3><ul><li>ä½¿ç”¨ä¸‰ç»´åˆ’åˆ†ã€‚<li>æˆ‘ä»¬çŸ¥é“ç»“æœçŸ©é˜µ C ä¸­çš„æ¯ä¸ªå…ƒç´ å®é™…ä¸Šæ˜¯ç”±$A$çš„è¡Œå’Œ$B$çš„åˆ—è¿›è¡Œä¸€ä¸ªç‚¹ä¹˜å¾—åˆ°çš„ã€‚æŠŠç‚¹ä¹˜æ“ä½œçš„å¤šæ¬¡ä¹˜æ³•è¿ç®—å±•å¼€æˆç¬¬ä¸‰ç»´ã€‚<li>å› æ­¤ï¼Œåœ¨è¿›ç¨‹ç«‹æ–¹ä¸­æ¯ä¸ªè¿›ç¨‹åªè´Ÿè´£äº†ä¸€æ¬¡ä¹˜åŠ æ“ä½œã€‚è€ŒäºŒç»´ç®—æ³•ä¸­è´Ÿè´£ä¸€æ¬¡ç‚¹ä¹˜æ“ä½œã€‚<li>DNS ç®—æ³•æœ€å¤šå…è®¸$n^3$ä¸ªè¿›ç¨‹å‚ä¸è®¡ç®—ã€‚<li>å‡è®¾æœ‰ä¸€ä¸ª$n\times n\times n$çš„è¿›ç¨‹é˜µåˆ—ã€‚<li>å°†$A$çš„ç¬¬$j$åˆ—å‘é€åˆ°ç¬¬$j$å±‚çš„æŸä¸€åˆ—è¿›ç¨‹ä¸­ï¼Œå°†$B$çš„ç¬¬$i$è¡Œå‘é€åˆ°ç¬¬$i$å±‚çš„æŸä¸€è¡Œè¿›ç¨‹ä¸­ï¼Œç„¶åå¯¹åŒå±‚è¿›è¡Œå¹¿æ’­ã€‚<li>æ¯ä¸ªå¤„ç†å™¨è®¡ç®—ä¸€ä¸ªå•ç‹¬çš„ä¹˜åŠ æ“ä½œã€‚<li>æ²¿ç€ç¬¬ä¸‰ç»´åšåŠ æ³•å½’çº¦ï¼Œç®—å‡ºå…·ä½“å¯¹åº”çš„çŸ©é˜µ$C$çš„æ¯ä¸€ä¸ªå…ƒç´ ã€‚<li>ä¸€ä¸ªä¹˜åŠ æ“ä½œè¿è¡Œæ—¶é—´æ˜¯ä¸€ä¸ªå¸¸æ•°ï¼Œè€Œå½’çº¦å’Œå¹¿æ’­å¤æ‚åº¦ä¸º$O(\log n)$ï¼Œå› æ­¤æ€»ä½“éœ€è¦çš„å¹¶è¡Œè¿è¡Œæ—¶é—´ä¸º$O(\log n)$ã€‚<li>ä½¿ç”¨$n^3$ä¸ªè¿›ç¨‹æ˜¯å¹¶ä¸æ˜¯æˆæœ¬æœ€ä¼˜çš„ã€‚<li>å‡è®¾è¿›ç¨‹çš„æ•°é‡æ˜¯å®Œå…¨ç«‹æ–¹æ•°$p=q^3$ã€‚<li>ä¸¤ä¸ªè¾“å…¥çŸ©é˜µè¢«åˆ’åˆ†æˆ$\frac{n}{q}\times\frac{n}{q}$çš„å—ã€‚<li>å› æ­¤çŸ©é˜µå¯ä»¥è¢«çœ‹åšæ˜¯ç”±è¿™äº›å—æ’æˆçš„$q\times q$äºŒç»´æ–¹é˜µã€‚<li>ç®—æ³•å’Œå‰é¢æ‰€è¿°æ˜¯å®Œå…¨ç±»ä¼¼çš„ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯æ¯ä¸ªè¿›ç¨‹ç°åœ¨å¯¹å­å—æ“ä½œè€Œä¸æ˜¯å¯¹çŸ©é˜µçš„å•ä¸ªå…ƒç´ æ“ä½œã€‚</ul><h3 id="æºä»£ç dnsc">æºä»£ç <code>DNS.c</code></h3><pre><code class="language-c">#include &lt;stdlib.h&gt;
#include &lt;math.h&gt;
#include &lt;mpi.h&gt;
typedef double lf;
lf getA(int i, int j) { return (i - 0.1 * j + 1) / (i + j + 1); }
lf getB(int i, int j) { return (j - 0.2 * i + 1) * (i + j + 1) / (i * i + j * j + 1); }
lf getX(int i) { return i / (i * i + 1.0); }
int main(int argc, char **argv)
{
	MPI_Init(&amp;argc, &amp;argv);
	int comSize, comRank, n = 1 &lt;&lt; atoi(argv[1]);
	MPI_Comm_size(MPI_COMM_WORLD, &amp;comSize);
	MPI_Comm_rank(MPI_COMM_WORLD, &amp;comRank);

	int sqSize = round(pow(comSize, 1.0 / 3)), //è¿›ç¨‹æ•°çš„å¼€ç«‹æ–¹
		sqLen = (n + sqSize - 1) / sqSize,	 //æ¯ä¸ªè¿›ç¨‹åˆ†åˆ°çŸ©å½¢çš„è¾¹é•¿
		hRank = comRank / sqSize / sqSize,
		rRank = comRank / sqSize % sqSize,
		cRank = comRank % sqSize,
		sqHet = rRank * sqSize + cRank,
		sqRow = cRank * sqSize + hRank,
		sqCol = hRank * sqSize + rRank;

	MPI_Comm hetComm, rowComm, colComm; //æŒ‰é«˜åˆ†çš„é€šä¿¡åŸŸæ˜¯ä¸€æ¡ç›´çº¿ï¼ŒæŒ‰è¡Œã€åˆ—åˆ†çš„é€šä¿¡åŸŸæ˜¯ä¸€ä¸ªäºŒç»´å¹³é¢
	MPI_Comm_split(MPI_COMM_WORLD, sqHet, hRank, &amp;hetComm);
	MPI_Comm_split(MPI_COMM_WORLD, sqRow, rRank, &amp;rowComm);
	MPI_Comm_split(MPI_COMM_WORLD, sqCol, cRank, &amp;colComm);

	lf *c = (lf *)malloc(sizeof(lf) * sqLen * sqLen),
	   *a = (lf *)malloc(sizeof(lf) * sqLen * sqLen),
	   *b = (lf *)malloc(sizeof(lf) * sqLen * sqLen);
	if (!hRank)
		for (int i = 0; i &lt; sqLen; ++i)
			for (int j = 0; j &lt; sqLen; ++j)
			{
				a[i * sqLen + j] = getA(rRank * sqLen + i, cRank * sqLen + j);
				b[j * sqLen + i] = getB(rRank * sqLen + i, cRank * sqLen + j); //bä¸­å­˜çš„æ˜¯è½¬ç½®
			}
	MPI_Bcast( //æŒ‰è¡Œå¹¿æ’­A
		a,
		sqLen * sqLen,
		MPI_DOUBLE,
		0,
		hetComm);
	MPI_Bcast( //æŒ‰åˆ—å¹¿æ’­B
		b,
		sqLen * sqLen,
		MPI_DOUBLE,
		0,
		hetComm);
	/*//ç›¸å½“äºæ¯ä¸ªè¿›ç¨‹æ‰§è¡Œä¸‹é¢çš„ä»£ç 
	for (int i = 0; i &lt; sqLen; ++i)
		for (int j = 0; j &lt; sqLen; ++j)
		{
			a[i * sqLen + j] = getA(sqRow * sqLen + i, sqHet * sqLen + j);
			b[i * sqLen + j] = getB(sqHet * sqLen + i, sqCol * sqLen + j);
		}
	*/
	for (int i = 0; i &lt; sqLen; ++i)
		for (int j = 0; j &lt; sqLen; ++j)
			for (int k = c[i * sqLen + j] = 0; k &lt; sqLen; ++k)
				c[i * sqLen + j] += a[i * sqLen + k] * b[j * sqLen + k];

	MPI_Reduce( //è§„çº¦ç­”æ¡ˆåˆ°æœ€ä¸‹é¢ä¸€å±‚
		hRank ? c : MPI_IN_PLACE,
		c,
		sqLen * sqLen,
		MPI_DOUBLE,
		MPI_SUM,
		0,
		hetComm);
	free(a), free(b), free(c);
	MPI_Finalize();
}
</code></pre><h3 id="è°ƒåº¦è„šæœ¬dnspbs">è°ƒåº¦è„šæœ¬<code>DNS.pbs</code></h3><p>è¿™é‡Œåªæ”¾å‡ºè¿è¡Œ 512 è¿›ç¨‹æ—¶çš„è°ƒåº¦è„šæœ¬ï¼Œå…¶ä»–åŒç†ã€‚</p><pre><code class="language-bash">#PBS -N DNS
#PBS -l nodes=16:ppn=32
#PBS -j oe

source /public/software/profile.d/mpi_openmpi-intel-2.1.2.sh

mpicc $PBS_O_WORKDIR/DNS.c -o $PBS_O_WORKDIR/DNS -std=c11 -lm
for logN in 6 7 8 9 10 11 12 13 14 15 16 17
do
time mpiexec -machinefile $PBS_NODEFILE $PBS_O_WORKDIR/DNS $logN
done
</code></pre><h3 id="è®¡ç®—ç®—æ³•çš„è¿è¡Œæ—¶é—´å¡«è¡¨-3">è®¡ç®—ç®—æ³•çš„è¿è¡Œæ—¶é—´ï¼Œå¡«è¡¨</h3><p><strong>ç”±äºç®—æ³•çš„å‰æè¦æ±‚ï¼Œå¹¶è¡Œçš„è¿›ç¨‹æ•°å¿…é¡»æ˜¯ç«‹æ–¹æ•°ã€‚</strong></p><p>è¯¦è§é™„ä»¶ä¸­çš„<code>DNS.o6678</code>~<code>DNS.o6681</code>ï¼Œåˆ†åˆ«å¯¹åº”äº†è¿›ç¨‹æ•° 512ã€64ã€8ã€1 çš„è¿è¡Œæ—¶é—´ã€‚ä¸‹è¡¨ä¸­çš„<code>x</code>ä»£è¡¨æ²¡æœ‰åœ¨é™å®šæ—¶é—´ä¸­æ±‚è§£å®Œæ¯•ã€‚</p><p>DNS ç®—æ³•ç›¸å¯¹ Cannon ç®—æ³•æ¥è¯´ï¼Œè™½ç„¶æ—¶é—´å¤æ‚åº¦æ²¡æœ‰æ”¹å˜ï¼Œä½†æ˜¯å¸¸æ•°æ›´å¤§ï¼Œè¿è¡Œé€Ÿåº¦æ›´æ…¢ï¼ˆå¯ä»¥å¯¹æ¯” 64 è¿›ç¨‹çš„è¿è¡Œæ—¶é—´ï¼‰ã€‚å…¶ä»–æƒ…å†µä¸‹çš„è¿è¡Œç»“æœå’Œç®€å•çŸ©é˜µä¹˜æ³•ç±»ä¼¼ï¼Œä¸å†èµ˜è¿°ã€‚</p><h4 id="è¿è¡Œæ—¶é—´-3">è¿è¡Œæ—¶é—´</h4><table><thead><tr><th>é—®é¢˜è§„æ¨¡\è¿›ç¨‹æ•°<th>1<th>8<th>64<th>512<tbody><tr><td>$2^6$<td>0.488<td>0.365<td>1.497<td>1.673<tr><td>$2^7$<td>0.489<td>0.569<td>1.123<td>1.445<tr><td>$2^8$<td>0.401<td>0.516<td>1.116<td>1.416<tr><td>$2^9$<td>0.436<td>0.450<td>1.100<td>1.445<tr><td>$2^{10}$<td>0.853<td>0.594<td>1.039<td>1.416<tr><td>$2^{11}$<td>6.585<td>1.259<td>1.149<td>1.448<tr><td>$2^{12}$<td>52.309<td>6.933<td>2.580<td>1.567<tr><td>$2^{13}$<td>413.207<td>54.147<td>14.935<td>2.699<tr><td>$2^{14}$<td>x<td>424.275<td>112.297<td>12.109<tr><td>$2^{15}$<td>x<td>x<td>882.313<td>66.739<tr><td>$2^{16}$<td>x<td>x<td>x<td>678.642<tr><td>$2^{17}$<td>x<td>x<td>x<td>x</table><h4 id="åŠ é€Ÿæ¯”-3">åŠ é€Ÿæ¯”</h4><table><thead><tr><th>é—®é¢˜è§„æ¨¡\è¿›ç¨‹æ•°<th>1<th>8<th>64<th>512<tbody><tr><td>$2^6$<td>1<td>1.336986301<td>0.325985304<td>0.291691572<tr><td>$2^7$<td>1<td>0.85940246<td>0.435440784<td>0.338408304<tr><td>$2^8$<td>1<td>0.777131783<td>0.359318996<td>0.28319209<tr><td>$2^9$<td>1<td>0.968888889<td>0.396363636<td>0.301730104<tr><td>$2^{10}$<td>1<td>1.436026936<td>0.820981713<td>0.60240113<tr><td>$2^{11}$<td>1<td>5.230341541<td>5.731070496<td>4.547651934<tr><td>$2^{12}$<td>1<td>7.544930045<td>20.2748062<td>33.38162093<tr><td>$2^{13}$<td>1<td>7.631207638<td>27.66702377<td>153.096332<tr><td>$2^{14}$<td>x<td>x<td>x<td>x<tr><td>$2^{15}$<td>x<td>x<td>x<td>x<tr><td>$2^{16}$<td>x<td>x<td>x<td>x<tr><td>$2^{17}$<td>x<td>x<td>x<td>x</table><h4 id="è¿è¡Œæ•ˆç‡-1">è¿è¡Œæ•ˆç‡</h4><table><thead><tr><th>é—®é¢˜è§„æ¨¡\è¿›ç¨‹æ•°<th>1<th>8<th>64<th>512<tbody><tr><td>$2^6$<td>1<td>0.167123288<td>0.00509352<td>0.00056971<tr><td>$2^7$<td>1<td>0.107425308<td>0.006803762<td>0.000660954<tr><td>$2^8$<td>1<td><strong>0.097141473</strong><td>0.005614359<td>0.00055311<tr><td>$2^9$<td>1<td>0.121111111<td>0.006193182<td>0.000589317<tr><td>$2^{10}$<td>1<td>0.179503367<td><strong>0.012827839</strong><td>0.001176565<tr><td>$2^{11}$<td>1<td>0.653792693<td>0.089547977<td>0.008882133<tr><td>$2^{12}$<td>1<td>0.943116256<td>0.316793847<td><strong>0.065198478</strong><tr><td>$2^{13}$<td>1<td>0.953900955<td>0.432297246<td>0.299016273<tr><td>$2^{14}$<td>x<td>x<td>x<td>x<tr><td>$2^{15}$<td>x<td>x<td>x<td>x<tr><td>$2^{16}$<td>x<td>x<td>x<td>x<tr><td>$2^{17}$<td>x<td>x<td>x<td>x</table><h4 id="éªŒè¯ç­‰æ•ˆç‡æ¨¡å‹-1">éªŒè¯ç­‰æ•ˆç‡æ¨¡å‹</h4><p>ä¸è€ƒè™‘å¹¶è¡Œå¼€é”€æ—¶ï¼ˆæ ¹æ®å¤æ–¯å¡”å¤«æ£®å®šå¾‹ï¼Œé—®é¢˜è§„æ¨¡å¤§çš„æ—¶å€™å¯å¿½ç•¥ï¼‰ï¼Œç­‰æ•ˆç‡å‡½æ•°$W(n)=\frac{n^3}{p^2}$ï¼Œå³$n\to p^{\frac{2}{3}}$ã€‚è§ã€Œè¿ç®—æ•ˆç‡ã€ä¸­æ ‡é»‘éƒ¨åˆ†ï¼ˆè¿›ç¨‹æ•°å¢åŠ äº† 8 å€ï¼Œé—®é¢˜è§„æ¨¡å¢åŠ  4 å€ï¼Œè¿ç®—æ•ˆç‡å¤„äºåŒä¸€ä¸ªæ•°é‡çº§ï¼‰ã€‚</p></div><script repo="wu-kan/utterances-storage" src="https://utteranc.es/client.js" issue-term="url" theme="github-light" crossorigin="anonymous" async="async" ></script></div></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" /><style> .katex-display>.katex { white-space: normal; }</style><script src="https://cdn.jsdelivr.net/combine/npm/katex@0.13.11/dist/katex.min.js,npm/katex@0.13.11/dist/contrib/auto-render.min.js" async="async" onload='renderMathInElement(document.body, { delimiters: [{left: "$$", right: "$$", display: true}, { left: "$", right: "$", display: false }, {left: "\\(", right: "\\)", display: false}, {left: "\\[", right: "\\]", display: true}]})' ></script><style> pre.language-mermaid, code.language-mermaid { display: none; } @media only screen { .mermaid { overflow: auto auto; max-width: 100%; max-height: 66.6vh; } }</style><script src="https://cdn.jsdelivr.net/npm/mermaid@8.10.1/dist/mermaid.min.js" async="async" onload=' for(let x of document.getElementsByClassName("language-mermaid")) if(x.nodeName=="CODE") { let m = document.createElement("div"); m.classList.add("mermaid"); m.textContent = x.textContent; x.parentNode.insertAdjacentElement("beforebegin", m); }' ></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/combine/npm/prismjs@1.23.0/plugins/line-numbers/prism-line-numbers.min.css,npm/prismjs@1.23.0/plugins/toolbar/prism-toolbar.min.css,npm/prismjs@1.23.0/plugins/match-braces/prism-match-braces.min.css,npm/prism-themes@1.5.0/themes/prism-nord.min.css" /> <script src="https://cdn.jsdelivr.net/combine/npm/prismjs@1.23.0/components/prism-core.min.js,npm/prismjs@1.23.0/plugins/autoloader/prism-autoloader.min.js,npm/prismjs@1.23.0/plugins/line-numbers/prism-line-numbers.min.js,npm/prismjs@1.23.0/plugins/toolbar/prism-toolbar.min.js,npm/prismjs@1.23.0/plugins/match-braces/prism-match-braces.min.js" async="async" data-autoloader-path="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/components/" onload=' for(let x of document.getElementsByClassName("content")) x.classList.add("line-numbers","match-braces"); Prism.plugins.toolbar.registerButton("select-code", function (env) { let button = document.createElement("button"); button.textContent = "select this " + env.language; button.addEventListener("click", function () { if (document.body.createTextRange) { let range = document.body.createTextRange(); range.moveToElementText(env.element); range.select(); } else if (window.getSelection) { let selection = window.getSelection(); let range = document.createRange(); range.selectNodeContents(env.element); selection.removeAllRanges(); selection.addRange(range); } }); return button; })' ></script></div><label for="sidebar-checkbox" class="sidebar-toggle"></label>
